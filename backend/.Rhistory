pvals.ks=c()
pvals.t=c()
pvals.wc=c()
gosem.random.vector=c()
for(i in 1: as.integer(config$NO_OF_random_permutations_for_functional_similarity))
{
genes.random=sample(all.entrez.genes,length(genes.entrez),replace = FALSE)
gosem.random=mgeneSim(genes.random,organism="human",measure="Wang")#,ont="BP"
gosem.random=gosem.random[upper.tri(gosem.random)]
gosem.random.vector=c(gosem.random.vector,gosem.random)
if(length(gosem.random)>1)
{
pvals.ks=c(pvals.ks,ks.test(gosem,gosem.random,alternative="l")$p.value)
pvals.wc=c(pvals.wc,wilcox.test(gosem,gosem.random,alternative="g")$p.value)
pvals.t=c(pvals.t,t.test(gosem,gosem.random,alternative="g")$p.value)
}
}
#   pval.t.final= (length(pvals.t[pvals.t > 0.05]) /  length(pvals.t))
#   pval.ks.final= (length(pvals.ks[pvals.ks > 0.05]) /  length(pvals.ks))
#   pval.wc.final= (length(pvals.wc[pvals.wc > 0.05]) /  length(pvals.wc))
pval=min(median(pvals.t),median(pvals.wc),median(pvals.ks))
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,3) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot
pval
median(pvals.t)
median(pvals.ks)
gosem.random.vector=c()
gosem.random.vector
genes.random=sample(all.entrez.genes,length(genes.entrez),replace = FALSE)
genes.random
gosem.random=mgeneSim(genes.random,organism="human",measure="Wang")#,ont="BP"
gosem.random
gosem.random=gosem.random[upper.tri(gosem.random)]
gosem.random
gosem.random.vector=c()
for(i in 1: as.integer(config$NO_OF_random_permutations_for_functional_similarity))
{
genes.random=sample(all.entrez.genes,length(genes.entrez),replace = FALSE)
gosem.random=mgeneSim(genes.random,organism="human",measure="Wang")#,ont="BP"
gosem.random=gosem.random[upper.tri(gosem.random)]
gosem.random.vector=c(gosem.random.vector,gosem.random)
if(length(gosem.random)>1)
{
pvals.ks=c(pvals.ks,ks.test(gosem,gosem.random,alternative="l")$p.value)
pvals.wc=c(pvals.wc,wilcox.test(gosem,gosem.random,alternative="g")$p.value)
pvals.t=c(pvals.t,t.test(gosem,gosem.random,alternative="g")$p.value)
}
}
#   pval.t.final= (length(pvals.t[pvals.t > 0.05]) /  length(pvals.t))
#   pval.ks.final= (length(pvals.ks[pvals.ks > 0.05]) /  length(pvals.ks))
#   pval.wc.final= (length(pvals.wc[pvals.wc > 0.05]) /  length(pvals.wc))
pval=min(median(pvals.t),median(pvals.wc),median(pvals.ks))
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
all.entrez.genes <- mappedkeys(org.Hs.egACCNUM)
pvals.ks=c()
pvals.t=c()
pvals.wc=c()
gosem.random.vector=c()
for(i in 1: as.integer(config$NO_OF_random_permutations_for_functional_similarity))
{
genes.random=sample(all.entrez.genes,length(genes.entrez),replace = FALSE)
gosem.random=mgeneSim(genes.random,organism="human",measure="Wang")#,ont="BP"
gosem.random=gosem.random[upper.tri(gosem.random)]
gosem.random.vector=c(gosem.random.vector,gosem.random)
if(length(gosem.random)>1)
{
pvals.ks=c(pvals.ks,ks.test(gosem,gosem.random,alternative="l")$p.value)
pvals.wc=c(pvals.wc,wilcox.test(gosem,gosem.random,alternative="g")$p.value)
pvals.t=c(pvals.t,t.test(gosem,gosem.random,alternative="g")$p.value)
}
}
pval=min(median(pvals.t),median(pvals.wc),median(pvals.ks))
pval
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
gosem.random.forplot
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,3) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
pval
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
length(gosem)
gosem.random.vector
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
?ks.test
ks.test(gosem,gosem.random.forplot,alternative="g")$p.value
ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
pval
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
?formatc
?format
fixed(1.128347132904321674821, digits=2)
specify_decimal(0.000001234, 5)
specify_decimal(0.000001234, 5)
specify_decimal <- function(x, k) format(round(x, k), nsmall=k)
specify_decimal(0.000001234, 5)
?format
format(2^31-1, scientific = TRUE)
format(pval, scientific = TRUE)
format(pval, scientific = TRUE,digits=2)
format(pval, scientific = TRUE,digits=1)
format(pval, scientific = TRUE,digits=3)
format(pval, scientific = TRUE,digits=2)
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
genes="SPI1, BACH1, GNA13, SACM1L, FLI1, RAB23, POLE4, MSH2, SERTAD2, SKI, PHC2, ATP6V1C1, MSH6, DHX40, DPP7, RCN2, CHAF1A, PKN2, MECP2, ARL5B, MYO1E, B2M, TYROBP, FLII, MSR1, P2RY10, WAS"
output.path="output/disease/funsim.png"
############################################
genes=as.vector(unlist(strsplit(genes,", ")))
genes.entrez=unique(as.vector(unlist(mget(as.character(genes), envir=org.Hs.egALIAS2EG, ifnotfound=NA))))
gosem=mgeneSim(genes.entrez,organism="human",measure="Wang")#,ont="BP"
gosem=gosem[upper.tri(gosem)]
all.entrez.genes <- mappedkeys(org.Hs.egACCNUM)
pvals.ks=c()
pvals.t=c()
pvals.wc=c()
gosem.random.vector=c()
for(i in 1: as.integer(config$NO_OF_random_permutations_for_functional_similarity))
{
genes.random=sample(all.entrez.genes,length(genes.entrez),replace = FALSE)
gosem.random=mgeneSim(genes.random,organism="human",measure="Wang")#,ont="BP"
gosem.random=gosem.random[upper.tri(gosem.random)]
gosem.random.vector=c(gosem.random.vector,gosem.random)
if(length(gosem.random)>1)
{
pvals.ks=c(pvals.ks,ks.test(gosem,gosem.random,alternative="l")$p.value)
pvals.wc=c(pvals.wc,wilcox.test(gosem,gosem.random,alternative="g")$p.value)
pvals.t=c(pvals.t,t.test(gosem,gosem.random,alternative="g")$p.value)
}
}
#   pval.t.final= (length(pvals.t[pvals.t > 0.05]) /  length(pvals.t))
#   pval.ks.final= (length(pvals.ks[pvals.ks > 0.05]) /  length(pvals.ks))
#   pval.wc.final= (length(pvals.wc[pvals.wc > 0.05]) /  length(pvals.wc))
#   pval=min(median(pvals.t),median(pvals.wc),median(pvals.ks))
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.vector
length(gosem)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
pval
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
genes="SPI1, BACH1, GNA13, SACM1L, FLI1, RAB23, POLE4, MSH2, SERTAD2, SKI, PHC2, ATP6V1C1, MSH6, DHX40, DPP7, RCN2, CHAF1A, PKN2, MECP2, ARL5B, MYO1E, B2M, TYROBP, FLII, MSR1, P2RY10, WAS"
output.path="output/disease/funsim.png"
############################################
genes=as.vector(unlist(strsplit(genes,", ")))
genes.entrez=unique(as.vector(unlist(mget(as.character(genes), envir=org.Hs.egALIAS2EG, ifnotfound=NA))))
gosem=mgeneSim(genes.entrez,organism="human",measure="Wang")#,ont="BP"
gosem=gosem[upper.tri(gosem)]
all.entrez.genes <- mappedkeys(org.Hs.egACCNUM)
pvals.ks=c()
pvals.t=c()
pvals.wc=c()
gosem.random.vector=c()
for(i in 1: as.integer(config$NO_OF_random_permutations_for_functional_similarity))
{
genes.random=sample(all.entrez.genes,length(genes.entrez),replace = FALSE)
gosem.random=mgeneSim(genes.random,organism="human",measure="Wang")#,ont="BP"
gosem.random=gosem.random[upper.tri(gosem.random)]
gosem.random.vector=c(gosem.random.vector,gosem.random)
#     if(length(gosem.random)>1)
#     {
#       pvals.ks=c(pvals.ks,ks.test(gosem,gosem.random,alternative="l")$p.value)
#       pvals.wc=c(pvals.wc,wilcox.test(gosem,gosem.random,alternative="g")$p.value)
#       pvals.t=c(pvals.t,t.test(gosem,gosem.random,alternative="g")$p.value)
#     }
}
#   pval.t.final= (length(pvals.t[pvals.t > 0.05]) /  length(pvals.t))
#   pval.ks.final= (length(pvals.ks[pvals.ks > 0.05]) /  length(pvals.ks))
#   pval.wc.final= (length(pvals.wc[pvals.wc > 0.05]) /  length(pvals.wc))
#   pval=min(median(pvals.t),median(pvals.wc),median(pvals.ks))
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
all.entrez.genes <- mappedkeys(org.Hs.egACCNUM)
all.entrez.genes
gosem.random.vector=c()
for(i in 1: as.integer(config$NO_OF_random_permutations_for_functional_similarity))
{
genes.random=sample(all.entrez.genes,length(genes.entrez),replace = FALSE)
gosem.random=mgeneSim(genes.random,organism="human",measure="Wang")#,ont="BP"
gosem.random=gosem.random[upper.tri(gosem.random)]
gosem.random.vector=c(gosem.random.vector,gosem.random)
#     if(length(gosem.random)>1)
#     {
#       pvals.ks=c(pvals.ks,ks.test(gosem,gosem.random,alternative="l")$p.value)
#       pvals.wc=c(pvals.wc,wilcox.test(gosem,gosem.random,alternative="g")$p.value)
#       pvals.t=c(pvals.t,t.test(gosem,gosem.random,alternative="g")$p.value)
#     }
}
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
CairoPNG(bg="transparent",output.path,width=as.integer(config$funsimilarity.diagram.width),height=as.integer(config$funsimilarity.diagram.height))
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
dev.off()
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=1, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=0.8, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=0.8, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
gosem.random.forplot=sample(gosem.random.vector,length(gosem))
pval=ks.test(gosem,gosem.random.forplot,alternative="l")$p.value
plot(ecdf(gosem),col="red", xlim=range(c(gosem, gosem.random.forplot)) , main="",xlab="Pair-wise similarity score", ylab="Cumulative distribution")
#lines(ecdf(gosem),col="red",type="l")
grid()
lines(ecdf(gosem.random.forplot))
#text(0.9,0.05, col="blue", paste("P-value < ",round(pval,4) ,sep=""),cex=1, adj = c(0.5, 0.5))
text(0.9,0.05, col="blue", paste("P-value < ",format(pval, scientific = TRUE,digits=2) ,sep=""),cex=0.8, adj = c(0.5, 0.5))
#mtext(paste("P-value < ",round(pval,3) ,sep=""), adj = 1,col="blue")
legend(bty="n","topleft",c("Motif genes CDF","Random genes CDF") ,pch=c(19,19), col=c("red","black") ,cex=1)
